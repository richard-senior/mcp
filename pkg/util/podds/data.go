package podds

import (
	"encoding/json"
	"fmt"

	"github.com/richard-senior/mcp/internal/logger"
	"github.com/richard-senior/mcp/pkg/util"
)

/////////////////////////////////////////////////////////////////////////
////// Team Data
/////////////////////////////////////////////////////////////////////////

var DataInstance *Data

// Holds information about football teams
type TeamData struct {
	Name      string  `json:"teamName"`
	Id        int     `json:"fotmobId"`
	Latitude  float64 `json:"latitude"`
	Longitude float64 `json:"longitude"`
}

// Position represents a league/season combination with team starting or finishing positions
type Position struct {
	Team      *TeamData      `json:"teamData,omitempty"`
	LeagueID  int            `json:"leagueId"`
	Season    string         `json:"season"`
	Positions map[string]int `json:"positions"`
}

// Data represents a football team's location data with database persistence
type Data struct {
	TeamsData        map[string]TeamData
	InitialPositions []Position
	FinalPositions   []Position
}

/* /^\s*"([^"]*)": \{"fotmobId": ([0-9]+),"latitude".*$/gm */
const teamdata = `{
    "Accrington": {"fotmobId": 8671,"latitude": 53.75,"longitude": -2.37},
    "Aldershot": {"fotmobId": 8465,"latitude": 51.25,"longitude": -0.76},
    "Arsenal": {"fotmobId": 9825,"latitude": 51.55,"longitude": -0.11},
    "Aston Villa": {"fotmobId": 10252,"latitude": 52.50,"longitude": -1.88},
    "Barnet": {"fotmobId": 8175,"latitude": 51.65,"longitude": -0.20},
    "Barnsley": {"fotmobId": 8283,"latitude": 53.55,"longitude": -1.47},
    "Barrow": {"fotmobId": 6350,"latitude": 54.12,"longitude": -3.24},
    "Birmingham": {"fotmobId": 8658,"latitude": 52.48,"longitude": -1.87},
    "Blackburn": {"fotmobId": 8655,"latitude": 53.73,"longitude": -2.49},
    "Blackpool": {"fotmobId": 8483,"latitude": 53.81,"longitude": -3.05},
    "Bolton": {"fotmobId": 8559,"latitude": 53.58,"longitude": -2.43},
    "Bournemouth": {"fotmobId": 8678,"latitude": 50.72,"longitude": -1.88},
    "Bradford": {"fotmobId": 8484,"latitude": 53.79,"longitude": -1.75},
    "Brentford": {"fotmobId": 9937,"latitude": 51.48,"longitude": -0.30},
    "Brighton": {"fotmobId": 10204,"latitude": 50.84,"longitude": -0.18},
    "Bristol City": {"fotmobId": 8427,"latitude": 51.45,"longitude": -2.60},
    "Bristol Rovers": {"fotmobId": 10104,"latitude": 51.49,"longitude": 2.58},
    "Bristol Rvs": {"fotmobId": 10104,"latitude": 51.49,"longitude": 2.58},
    "Bromley": {"fotmobId": 45729,"latitude": 51.40,"longitude": 0.02},
    "Burnley": {"fotmobId": 8191,"latitude": 53.80,"longitude": -2.27},
    "Burton": {"fotmobId": 9792,"latitude": 52.82,"longitude": -1.63},
    "Bury": {"fotmobId": 9895,"latitude": 53.58,"longitude": -2.30},
    "Cambridge": {"fotmobId": 9834,"latitude": 52.20,"longitude": 0.12},
    "Cardiff": {"fotmobId": 8344,"latitude": 51.48,"longitude": -3.18},
    "Carlisle": {"fotmobId": 10196,"latitude": 54.89,"longitude": -2.94},
    "Charlton": {"fotmobId": 8451,"latitude": 51.49,"longitude": 0.03},
    "Chelsea": {"fotmobId": 8455,"latitude": 51.51,"longitude": -0.19},
    "Cheltenham": {"fotmobId": 8680,"latitude": 51.90,"longitude": -2.08},
    "Chesterfield": {"fotmobId": 9786,"latitude": 53.24,"longitude": -1.42},
    "Colchester": {"fotmobId": 8416,"latitude": 51.89,"longitude": 0.90},
    "Coventry": {"fotmobId": 8669,"latitude": 52.41,"longitude": -1.51},
    "Crawley": {"fotmobId": 8647,"latitude": 51.12,"longitude": -0.19},
    "Crawley Town": {"fotmobId": 8647,"latitude": 51.12,"longitude": -0.19},
    "Crewe": {"fotmobId": 9784,"latitude": 53.10,"longitude": -2.45},
    "Crystal Palace": {"fotmobId": 9826,"latitude": 51.41,"longitude": -0.09},
    "Dagenham": {"fotmobId": 8009,"latitude": 51.55,"longitude": 0.15},
    "Dag and Red": {"fotmobId": 8009,"latitude": 51.55,"longitude": 0.15},
    "Derby": {"fotmobId": 10170,"latitude": 52.92,"longitude": -1.48},
    "Doncaster": {"fotmobId": 9903,"latitude": 53.52,"longitude": -1.13},
    "Everton": {"fotmobId": 8668,"latitude": 52.44,"longitude": -2.79},
    "Exeter": {"fotmobId": 9833,"latitude": 50.74,"longitude": -3.52},
    "Fleetwood": {"fotmobId": 45723,"latitude": 53.92,"longitude": -3.02},
    "Fleetwood Town": {"fotmobId": 45723,"latitude": 53.92,"longitude": -3.02},
    "Forest Green": {"fotmobId": 9828,"latitude": 51.50,"longitude": -2.14},
    "Fulham": {"fotmobId": 9879,"latitude": 51.48,"longitude": -0.21},
    "Gillingham": {"fotmobId": 10173,"latitude": 51.38,"longitude": 0.56},
    "Grimsby": {"fotmobId": 10005,"latitude": 53.56,"longitude": -0.07},
    "Harrogate": {"fotmobId": 7946,"latitude": 54.00,"longitude": -1.50},
    "Hartlepool": {"fotmobId": 8488,"latitude": 54.68,"longitude": -1.22},
    "Hartlepool United": {"fotmobId": 8488,"latitude": 54.68,"longitude": -1.22},
    "Hereford": {"fotmobId": 799249,"latitude": 52.05,"longitude": -2.72},
    "Hereford United": {"fotmobId": 9787,"latitude": 52.05,"longitude": -2.72},
    "Huddersfield": {"fotmobId": 9796,"latitude": 53.65,"longitude": -1.78},
    "Hull": {"fotmobId": 8667,"latitude": 53.75,"longitude": -0.33},
    "Ipswich": {"fotmobId": 9902,"latitude": 52.06,"longitude": 1.16},
    "Leeds": {"fotmobId": 8463,"latitude": 53.78,"longitude": -1.57},
    "Leicester": {"fotmobId": 8197,"latitude": 52.63,"longitude": -1.14},
    "Leyton Orient": {"fotmobId": 8351,"latitude": 51.56,"longitude": -0.01},
    "Lincoln": {"fotmobId": 8430,"latitude": 53.3,"longitude": -0.54},
    "Liverpool": {"fotmobId": 8650,"latitude": 53.43,"longitude": -2.96},
    "Luton": {"fotmobId": 8346,"latitude": 51.88,"longitude": -0.43},
    "Macclesfield": {"fotmobId": 8599,"latitude": 53.25,"longitude": -2.13},
    "MK Dons": {"fotmobId": 8645,"latitude": 52.04,"longitude": -0.78},
    "Milton Keynes Dons": {"fotmobId": 8645,"latitude": 52.04,"longitude": -0.78},
    "Man City": {"fotmobId": 8456,"latitude": 53.48,"longitude": -2.20},
    "Man United": {"fotmobId": 10260,"latitude": 53.46,"longitude": -2.29},
    "Mansfield": {"fotmobId": 9818,"latitude": 53.15,"longitude": -1.18},
    "Middlesbrough": {"fotmobId": 8549,"latitude": 54.58,"longitude": -1.23},
    "Millwall": {"fotmobId": 10004,"latitude": 51.48,"longitude": 0.04},
    "Morecambe": {"fotmobId": 8489,"latitude": 54.06,"longitude": -2.87},
    "Newcastle": {"fotmobId": 10261,"latitude": 54.98,"longitude": -1.62},
    "Newport": {"fotmobId": 10262,"latitude": 51.60,"longitude": -3.00},
    "Northampton": {"fotmobId": 8651,"latitude": 52.24,"longitude": -0.93},
    "Norwich": {"fotmobId": 9850,"latitude": 52.61,"longitude": 1.31},
    "Nottm Forest": {"fotmobId": 10203,"latitude": 52.94,"longitude": -1.13},
    "Notts Forest": {"fotmobId": 10203,"latitude": 52.94,"longitude": -1.13},
    "Nott'm Forest": {"fotmobId": 10203,"latitude": 52.94,"longitude": -1.13},
    "Notts County": {"fotmobId": 9819,"latitude": 52.94,"longitude": -1.14},
    "Oldham": {"fotmobId": 9785,"latitude": 53.56,"longitude": -2.13},
    "Oxford": {"fotmobId": 8653,"latitude": 51.75,"longitude": -1.26},
    "Oxford Utd": {"fotmobId": 8653,"latitude": 51.75,"longitude": -1.26},
    "Peterborough": {"fotmobId": 8677,"latitude": 52.57,"longitude": -0.25},
    "Peterboro": {"fotmobId": 8677,"latitude": 52.57,"longitude": -0.25},
    "Plymouth": {"fotmobId": 8401,"latitude": 50.39,"longitude": -4.15},
    "Port Vale": {"fotmobId": 9799,"latitude": 53.05,"longitude": -2.19},
    "Portsmouth": {"fotmobId": 8462,"latitude": 50.79,"longitude": -1.06},
    "Preston": {"fotmobId": 8411,"latitude": 53.77,"longitude": -2.68},
    "QPR": {"fotmobId": 10172,"latitude": 51.51,"longitude": -0.23},
    "Reading": {"fotmobId": 9798,"latitude": 51.42,"longitude": -0.98},
    "Rochdale": {"fotmobId": 8493,"latitude": 53.62,"longitude": -2.18},
    "Rotherham": {"fotmobId": 8119,"latitude": 53.42,"longitude": -1.33},
    "Salford": {"fotmobId": 282326,"latitude": 53.48,"longitude": -2.29},
    "Scunthorpe": {"fotmobId": 8412,"latitude": 53.59,"longitude": -0.7},
    "Sheff Utd": {"fotmobId": 8657,"latitude": 53.37,"longitude": -1.47},
    "Sheffield United": {"fotmobId": 8657,"latitude": 53.37,"longitude": -1.47},
    "Sheff Wed": {"fotmobId": 10163,"latitude": 53.41,"longitude": -1.5},
    "Sheffield Weds": {"fotmobId": 10163,"latitude": 53.41,"longitude": -1.5},
    "Sheffield Wednesday": {"fotmobId": 10163,"latitude": 53.41,"longitude": -1.5},
    "Shrewsbury": {"fotmobId": 9896,"latitude": 52.72,"longitude": -2.75},
    "Southampton": {"fotmobId": 8466,"latitude": 50.90,"longitude": -1.39},
    "Southend": {"fotmobId": 8652,"latitude": 51.54,"longitude": 0.71},
    "Stevenage": {"fotmobId": 10253,"latitude": 51.90,"longitude": -2.03},
    "Stockport": {"fotmobId": 10007,"latitude": 53.40,"longitude": -2.17},
    "Stockport County": {"fotmobId": 10007,"latitude": 53.40,"longitude": -2.17},
    "Stoke": {"fotmobId": 10194,"latitude": 53.00,"longitude": -2.18},
    "Sunderland": {"fotmobId": 8472,"latitude": 54.90,"longitude": -1.40},
    "Sutton": {"fotmobId": 158316,"latitude": 53.12,"longitude": -1.29},
    "Swansea": {"fotmobId": 10003,"latitude": 51.62,"longitude": -3.94},
    "Swindon": {"fotmobId": 9795,"latitude": 51.57,"longitude": -1.78},
    "Torquay": {"fotmobId": 10193,"latitude": 50.48,"longitude": -3.52},
    "Tottenham": {"fotmobId": 8586,"latitude": 51.60,"longitude": -0.07},
    "Tranmere": {"fotmobId": 8313,"latitude": 53.37,"longitude": -3.03},
    "Walsall": {"fotmobId": 10006,"latitude": 52.57,"longitude": -1.99},
    "Watford": {"fotmobId": 9817,"latitude": 51.65,"longitude": -0.40},
    "West Brom": {"fotmobId": 8659,"latitude": 52.52,"longitude": -1.99},
    "West Ham": {"fotmobId": 8654,"latitude": 51.58,"longitude": 0.03},
    "Wigan": {"fotmobId": 8528,"latitude": 53.54,"longitude": -2.65},
    "Wimbledon": {"fotmobId": 158319,"latitude": 51.43,"longitude": -0.19},
    "AFC Wimbledon": {"fotmobId": 158319,"latitude": 51.43,"longitude": -0.19},
    "Wolves": {"fotmobId": 8602,"latitude": 52.59,"longitude": -2.13},
    "Wrexham": {"fotmobId": 9841,"latitude": 53.05,"longitude": -2.99},
    "Wycombe": {"fotmobId": 8676,"latitude": 51.63,"longitude": -0.8},
    "Yeovil": {"fotmobId": 10198,"latitude": 50.95,"longitude": 2.67},
    "York": {"fotmobId": 9916,"latitude": 54.00,"longitude": 1.10}
}`

/////////////////////////////////////////////////////////////////////////
////// Final Positions
/////////////////////////////////////////////////////////////////////////

const FINAL_POSITIONS = `[
  {"leagueId":47,"season":"2010/2011","positions":{"1":10260,"2":8455,"3":8456,"4":9825,"5":8586,"6":8650,"7":8668,"8":9879,"9":10252,"10":8472,"11":8659,"12":10261,"13":10194,"14":8559,"15":8655,"16":8528,"17":8602,"18":8658,"19":8483,"20":8654}},
  {"leagueId":47,"season":"2011/2012","positions":{"1":8456,"2":10260,"3":9825,"4":8586,"5":10261,"6":8455,"7":8668,"8":8650,"9":9879,"10":8659,"11":10003,"12":9850,"13":8472,"14":10194,"15":8528,"16":10252,"17":10172,"18":8559,"19":8655,"20":8602}},
  {"leagueId":47,"season":"2012/2013","positions":{"1":10260,"2":8456,"3":8455,"4":9825,"5":8586,"6":8668,"7":8650,"8":8659,"9":10003,"10":8654,"11":9850,"12":9879,"13":10194,"14":8466,"15":10252,"16":10261,"17":8472,"18":8528,"19":9798,"20":10172}},
  {"leagueId":47,"season":"2013/2014","positions":{"1":8456,"2":8650,"3":8455,"4":9825,"5":8668,"6":8586,"7":10260,"8":8466,"9":10194,"10":10261,"11":9826,"12":10003,"13":8654,"14":8472,"15":10252,"16":8667,"17":8659,"18":9850,"19":9879,"20":8344}},
  {"leagueId":47,"season":"2014/2015","positions":{"1":8455,"2":8456,"3":9825,"4":10260,"5":8586,"6":8650,"7":8466,"8":10003,"9":10194,"10":9826,"11":8668,"12":8654,"13":8659,"14":8197,"15":10261,"16":8472,"17":10252,"18":8667,"19":8191,"20":10172}},
  {"leagueId":47,"season":"2015/2016","positions":{"1":8197,"2":9825,"3":8586,"4":8456,"5":10260,"6":8466,"7":8654,"8":8650,"9":10194,"10":8455,"11":8668,"12":10003,"13":9817,"14":8659,"15":9826,"16":8678,"17":8472,"18":10261,"19":9850,"20":10252}},
  {"leagueId":47,"season":"2016/2017","positions":{"1":8455,"2":8586,"3":8456,"4":8650,"5":9825,"6":10260,"7":8668,"8":8466,"9":8678,"10":8659,"11":8654,"12":8197,"13":10194,"14":9826,"15":10003,"16":8191,"17":9817,"18":8667,"19":8549,"20":8472}},
  {"leagueId":47,"season":"2017/2018","positions":{"1":8456,"2":10260,"3":8586,"4":8650,"5":8455,"6":9825,"7":8191,"8":8668,"9":8197,"10":10261,"11":9826,"12":8678,"13":8654,"14":9817,"15":10204,"16":9796,"17":8466,"18":10003,"19":10194,"20":8659}},
  {"leagueId":47,"season":"2018/2019","positions":{"1":8456,"2":8650,"3":8455,"4":8586,"5":9825,"6":10260,"7":8602,"8":8668,"9":8197,"10":8654,"11":9817,"12":9826,"13":10261,"14":8678,"15":8191,"16":8466,"17":10204,"18":8344,"19":9879,"20":9796}},
  {"leagueId":47,"season":"2019/2020","positions":{"1":8650,"2":8456,"3":10260,"4":8455,"5":8197,"6":8586,"7":8602,"8":9825,"9":8657,"10":8191,"11":8466,"12":8668,"13":10261,"14":9826,"15":10204,"16":8654,"17":10252,"18":8678,"19":9817,"20":9850}},
  {"leagueId":47,"season":"2020/2021","positions":{"1":8456,"2":10260,"3":8650,"4":8455,"5":8197,"6":8654,"7":8586,"8":9825,"9":8463,"10":8668,"11":10252,"12":10261,"13":8602,"14":9826,"15":8466,"16":10204,"17":8191,"18":9879,"19":8659,"20":8657}},
  {"leagueId":47,"season":"2021/2022","positions":{"1":8456,"2":8650,"3":8455,"4":8586,"5":9825,"6":10260,"7":8654,"8":8197,"9":10204,"10":8602,"11":10261,"12":9826,"13":9937,"14":10252,"15":8466,"16":8668,"17":8463,"18":8191,"19":9817,"20":9850}},
  {"leagueId":47,"season":"2022/2023","positions":{"1":8456,"2":9825,"3":10260,"4":10261,"5":8650,"6":10204,"7":10252,"8":8586,"9":9937,"10":9879,"11":9826,"12":8455,"13":8602,"14":8654,"15":8678,"16":10203,"17":8668,"18":8197,"19":8463,"20":8466}},
  {"leagueId":47,"season":"2023/2024","positions":{"1":8456,"2":9825,"3":8650,"4":10252,"5":8586,"6":8455,"7":10261,"8":10260,"9":8654,"10":9826,"11":10204,"12":8678,"13":9879,"14":8602,"15":8668,"16":9937,"17":10203,"18":8346,"19":8191,"20":8657}},
  {"leagueId":47,"season":"2024/2025","positions":{"1":8650,"2":9825,"3":8456,"4":8455,"5":10261,"6":10252,"7":10203,"8":10204,"9":8678,"10":9937,"11":9879,"12":9826,"13":8668,"14":8654,"15":10260,"16":8602,"17":8586,"18":8197,"19":9902,"20":8466}},
  {"leagueId":48,"season":"2010/2011","positions":{"1":10172,"2":9850,"3":10003,"4":8344,"5":9798,"6":10203,"7":8463,"8":8191,"9":10004,"10":8197,"11":8667,"12":8549,"13":9902,"14":9817,"15":8427,"16":8462,"17":8283,"18":8669,"19":10170,"20":9826,"21":9903,"22":8411,"23":8657,"24":8412}},
  {"leagueId":48,"season":"2011/2012","positions":{"1":9798,"2":8466,"3":8654,"4":8658,"5":8483,"6":8344,"7":8549,"8":8667,"9":8197,"10":10204,"11":9817,"12":10170,"13":8191,"14":8463,"15":9902,"16":10004,"17":9826,"18":8677,"19":10203,"20":8427,"21":8283,"22":8462,"23":8669,"24":9903}},
  {"leagueId":48,"season":"2012/2013","positions":{"1":8344,"2":8667,"3":9826,"4":9817,"5":10204,"6":8197,"7":8559,"8":10203,"9":8451,"10":10170,"11":8191,"12":8658,"13":8463,"14":9902,"15":8483,"16":8549,"17":8655,"18":10163,"19":9796,"20":10004,"21":8283,"22":8677,"23":8602,"24":8427}},
  {"leagueId":48,"season":"2013/2014","positions":{"1":8197,"2":8191,"3":10172,"4":10170,"5":8528,"6":10204,"7":9798,"8":8655,"9":9902,"10":8678,"11":10203,"12":8549,"13":9817,"14":8559,"15":8463,"16":10163,"17":9796,"18":8451,"19":10004,"20":8483,"21":8658,"22":9903,"23":8283,"24":10198}},
  {"leagueId":48,"season":"2014/2015","positions":{"1":8678,"2":9817,"3":9850,"4":8549,"5":9937,"6":9902,"7":8602,"8":10170,"9":8655,"10":8658,"11":8344,"12":8451,"13":10163,"14":10203,"15":8463,"16":9796,"17":9879,"18":8559,"19":9798,"20":10204,"21":8119,"22":10004,"23":8528,"24":8483}},
  {"leagueId":48,"season":"2015/2016","positions":{"1":8191,"2":8549,"3":8667,"4":10204,"5":10170,"6":10163,"7":9902,"8":8344,"9":9937,"10":8658,"11":8411,"12":10172,"13":8463,"14":8602,"15":8655,"16":10203,"17":9798,"18":8427,"19":9796,"20":9879,"21":8119,"22":8451,"23":8645,"24":8559}},
  {"leagueId":48,"season":"2016/2017","positions":{"1":10261,"2":10204,"3":9796,"4":9798,"5":10163,"6":9879,"7":8463,"8":9850,"9":10170,"10":9937,"11":8411,"12":8344,"13":10252,"14":8283,"15":8602,"16":9902,"17":8427,"18":10172,"19":8658,"20":9792,"21":10203,"22":8655,"23":8528,"24":8119}},
  {"leagueId":48,"season":"2017/2018","positions":{"1":8602,"2":8344,"3":9879,"4":10252,"5":8549,"6":10170,"7":8411,"8":10004,"9":9937,"10":8657,"11":8427,"12":9902,"13":8463,"14":9850,"15":10163,"16":10172,"17":10203,"18":8667,"19":8658,"20":9798,"21":8559,"22":8283,"23":9792,"24":8472}},
  {"leagueId":48,"season":"2018/2019","positions":{"1":9850,"2":8657,"3":10252,"4":8463,"5":8659,"6":10170,"7":8549,"8":8427,"9":10203,"10":10003,"11":9937,"12":10163,"13":8667,"14":8411,"15":8655,"16":10194,"17":8658,"18":8528,"19":10172,"20":9798,"21":10004,"22":8119,"23":8559,"24":9902}},
  {"leagueId":48,"season":"2019/2020","positions":{"1":8463,"2":8659,"3":9879,"4":9937,"5":8344,"6":10003,"7":10203,"8":10004,"9":8411,"10":10170,"11":8655,"12":8427,"13":10172,"14":9798,"15":10194,"16":10163,"17":8549,"18":9796,"19":8346,"20":8658,"21":8283,"22":8451,"23":8528,"24":8667}},
  {"leagueId":48,"season":"2020/2021","positions":{"1":9850,"2":9817,"3":9937,"4":10003,"5":8283,"6":8678,"7":9798,"8":8344,"9":10172,"10":8549,"11":10004,"12":8346,"13":8411,"14":10194,"15":8655,"16":8669,"17":10203,"18":8658,"19":8427,"20":9796,"21":10170,"22":8676,"23":8119,"24":10163}},
  {"leagueId":48,"season":"2021/2022","positions":{"1":9879,"2":8678,"3":10203,"4":9796,"5":8657,"6":8346,"7":8549,"8":8655,"9":10004,"10":8659,"11":10172,"12":8669,"13":8411,"14":10194,"15":10003,"16":8483,"17":8427,"18":8344,"19":8667,"20":8658,"21":9798,"22":8677,"23":10170,"24":8283}},
  {"leagueId":48,"season":"2022/2023","positions":{"1":8191,"2":8657,"3":8346,"4":8549,"5":8669,"6":8472,"7":8655,"8":10004,"9":8659,"10":10003,"11":9817,"12":8411,"13":9850,"14":8427,"15":8667,"16":10194,"17":8658,"18":9796,"19":8119,"20":10172,"21":8344,"22":9798,"23":8483,"24":8528}},
  {"leagueId":48,"season":"2023/2024","positions":{"1":8197,"2":9902,"3":8466,"4":8463,"5":8659,"6":9850,"7":8667,"8":8549,"9":8669,"10":8411,"11":8427,"12":8344,"13":10004,"14":10003,"15":9817,"16":8472,"17":10194,"18":10172,"19":8655,"20":10163,"21":8401,"22":8658,"23":9796,"24":8119}},
  {"leagueId":48,"season":"2024/2025","positions":{"1":8463,"2":8191,"3":8657,"4":8472,"5":8549,"6":8659,"7":8655,"8":9817,"9":10004,"10":8669,"11":8411,"12":10194,"13":9850,"14":8667,"15":10172,"16":8427,"17":10003,"18":10194,"19":8411,"20":8346,"21":8667,"22":8346,"23":8401,"24":8344}},
  {"leagueId":108,"season":"2010/2011","positions":{"1":10204,"2":8466,"3":9796,"4":8677,"5":8645,"6":8678,"7":8351,"8":9833,"9":8493,"10":8416,"11":9937,"12":10196,"13":8451,"14":10198,"15":10163,"16":8488,"17":9785,"18":8313,"19":9819,"20":10006,"21":8009,"22":10104,"23":8401,"24":9795}},
  {"leagueId":108,"season":"2011/2012","positions":{"1":8451,"2":10163,"3":9796,"4":8657,"5":8645,"6":10253,"7":9819,"8":10196,"9":9937,"10":8416,"11":8678,"12":8313,"13":8488,"14":9895,"15":8411,"16":9785,"17":10198,"18":8412,"19":10006,"20":8351,"21":8676,"22":9786,"23":9833,"24":8493}},
  {"leagueId":108,"season":"2012/2013","positions":{"1":9903,"2":8678,"3":10198,"4":9937,"5":8657,"6":9795,"7":8351,"8":8645,"9":10006,"10":8647,"11":8313,"12":9819,"13":9784,"14":8411,"15":8669,"16":9896,"17":10196,"18":10253,"19":9785,"20":8416,"21":8412,"22":9895,"23":8488,"24":8462}},
  {"leagueId":108,"season":"2013/2014","positions":{"1":8602,"2":9937,"3":8119,"4":8351,"5":8411,"6":8677,"7":8657,"8":9795,"9":9799,"10":8645,"11":8484,"12":8427,"13":10006,"14":8647,"15":9785,"16":8416,"17":10173,"18":8669,"19":9784,"20":9819,"21":8313,"22":10196,"23":9896,"24":10253}},
  {"leagueId":108,"season":"2014/2015","positions":{"1":8427,"2":8645,"3":8411,"4":9795,"5":8657,"6":9786,"7":8484,"8":8493,"9":8677,"10":45723,"11":8283,"12":10173,"13":9903,"14":10006,"15":9785,"16":8412,"17":8669,"18":9799,"19":8416,"20":9784,"21":9819,"22":8647,"23":8351,"24":10198}},
  {"leagueId":108,"season":"2015/2016","positions":{"1":8528,"2":9792,"3":8283,"4":10006,"5":10004,"6":8484,"7":8412,"8":8669,"9":10173,"10":8493,"11":8657,"12":9799,"13":8677,"14":8652,"15":9795,"16":9895,"17":9785,"18":9786,"19":45723,"20":9896,"21":9903,"22":8483,"23":8416,"24":9784}},
  {"leagueId":108,"season":"2016/2017","positions":{"1":8657,"2":8559,"3":10004,"4":8412,"5":45723,"6":8484,"7":8652,"8":8653,"9":8493,"10":10104,"11":8677,"12":8645,"13":8451,"14":10006,"15":158319,"16":8651,"17":9785,"18":9896,"19":9895,"20":10173,"21":9799,"22":9795,"23":8669,"24":9786}},
  {"leagueId":108,"season":"2017/2018","positions":{"1":8528,"2":8655,"3":8119,"4":9896,"5":8412,"6":8451,"7":8401,"8":8462,"9":8677,"10":8652,"11":8484,"12":8483,"13":10104,"14":45723,"15":9903,"16":8653,"17":10173,"18":158319,"19":10006,"20":8493,"21":9785,"22":8651,"23":8645,"24":9895}},
  {"leagueId":108,"season":"2018/2019","positions":{"1":8346,"2":8283,"3":8451,"4":8462,"5":8472,"6":9903,"7":8677,"8":8669,"9":9792,"10":8483,"11":45723,"12":8653,"13":10173,"14":8671,"15":10104,"16":8493,"17":8676,"18":9896,"19":8652,"20":158319,"21":8401,"22":10006,"23":8412,"24":8484}},
  {"leagueId":108,"season":"2019/2020","positions":{"1":8669,"2":8119,"3":8676,"4":8653,"5":8462,"6":45723,"7":8677,"8":8472,"9":9903,"10":10173,"11":9902,"12":9792,"13":8483,"14":10104,"15":9896,"16":8430,"17":8671,"18":8493,"19":8645,"20":158319,"21":8313,"22":8652,"23":8559}},
  {"leagueId":108,"season":"2020/2021","positions":{"1":8667,"2":8677,"3":8483,"4":8472,"5":8430,"6":8653,"7":8451,"8":8462,"9":9902,"10":10173,"11":8671,"12":9784,"13":8645,"14":9903,"15":45723,"16":9792,"17":9896,"18":8401,"19":158319,"20":8528,"21":8493,"22":8651,"23":9795,"24":10104}},
  {"leagueId":108,"season":"2021/2022","positions":{"1":8528,"2":8119,"3":8472,"4":8645,"5":10163,"6":8676,"7":8401,"8":8653,"9":8559,"10":8462,"11":9902,"12":8671,"13":8451,"14":9834,"15":8680,"16":9792,"17":8430,"18":9896,"19":8489,"20":45723,"21":10173,"22":9903,"23":158319,"24":9784}},
  {"leagueId":108,"season":"2022/2023","positions":{"1":8401,"2":9902,"3":10163,"4":8283,"5":8559,"6":8677,"7":10170,"8":8462,"9":8676,"10":8451,"11":8430,"12":9896,"13":45723,"14":9833,"15":9792,"16":8680,"17":10104,"18":9799,"19":8653,"20":9834,"21":8645,"22":8489,"23":8671,"24":9828}},
  {"leagueId":108,"season":"2023/2024","positions":{"1":8462,"2":10170,"3":8653,"4":8559,"5":8677,"6":8283,"7":8430,"8":8483,"9":10253,"10":8676,"11":8351,"12":8528,"13":9833,"14":8651,"15":10104,"16":8451,"17":9798,"18":9834,"19":9896,"20":9792,"21":8680,"22":45723,"23":9799,"24":10196}},
  {"leagueId":109,"season":"2010/2011","positions":{"1":9786,"2":9895,"3":8676,"4":9896,"5":8671,"6":10253,"7":10193,"8":10173,"9":8119,"10":9784,"11":9799,"12":8653,"13":8652,"14":8465,"15":799249,"16":8651,"17":8680,"18":8484,"19":9792,"20":8489,"21":8599,"22":8175,"23":8430,"24":10007}},
  {"leagueId":109,"season":"2011/2012","positions":{"1":9795,"2":9896,"3":8647,"4":8652,"5":10193,"6":8680,"7":9784,"8":10173,"9":8653,"10":8119,"11":8465,"12":9799,"13":10104,"14":8671,"15":8489,"16":158319,"17":9792,"18":8484,"19":8009,"20":8651,"21":8401,"22":8175,"23":799249,"24":8599}},
  {"leagueId":109,"season":"2012/2013","positions":{"1":10173,"2":8119,"3":9799,"4":9792,"5":8680,"6":8651,"7":8484,"8":9786,"9":8653,"10":9833,"11":8652,"12":8493,"13":45723,"14":10104,"15":8676,"16":8489,"17":9916,"18":8671,"19":10193,"20":158319,"21":8401,"22":8009,"23":8175,"24":8465}},
  {"leagueId":109,"season":"2013/2014","positions":{"1":9786,"2":8412,"3":8493,"4":45723,"5":8652,"6":9792,"7":9916,"8":8653,"9":8009,"10":8401,"11":9818,"12":9895,"13":8462,"14":10262,"15":8671,"16":9833,"17":8680,"18":8489,"19":8488,"20":158319,"21":8651,"22":8676,"23":10104,"24":10193}},
  {"leagueId":109,"season":"2014/2015","positions":{"1":9792,"2":9896,"3":9895,"4":8676,"5":8652,"6":10253,"7":8401,"8":8346,"9":10262,"10":9833,"11":8489,"12":8651,"13":8653,"14":8009,"15":158319,"16":8462,"17":8671,"18":9916,"19":9834,"20":10196,"21":9818,"22":8488,"23":8680,"24":8313}},
  {"leagueId":109,"season":"2015/2016","positions":{"1":8651,"2":8653,"3":10104,"4":8671,"5":8401,"6":8462,"7":158319,"8":8351,"9":9834,"10":10196,"11":8346,"12":9818,"13":8676,"14":9833,"15":8175,"16":8488,"17":9819,"18":10253,"19":10198,"20":8647,"21":8489,"22":10262,"23":8009,"24":9916}},
  {"leagueId":109,"season":"2016/2017","positions":{"1":8462,"2":8401,"3":9903,"4":8346,"5":9833,"6":10196,"7":8483,"8":8416,"9":8676,"10":10253,"11":9834,"12":9818,"13":8671,"14":10005,"15":8175,"16":9819,"17":9784,"18":8489,"19":8647,"20":10198,"21":8680,"22":10262,"23":8488,"24":8351}},
  {"leagueId":109,"season":"2017/2018","positions":{"1":8671,"2":8346,"3":8676,"4":9833,"5":9819,"6":8669,"7":8430,"8":9818,"9":9795,"10":10196,"11":10262,"12":9834,"13":8416,"14":8647,"15":9784,"16":10253,"17":8680,"18":10005,"19":10198,"20":9799,"21":9828,"22":8489,"23":8175,"24":9786}},
  {"leagueId":109,"season":"2018/2019","positions":{"1":8430,"2":9895,"3":8645,"4":9818,"5":9828,"6":8313,"7":10262,"8":8416,"9":9833,"10":10253,"11":10196,"12":9784,"13":9795,"14":8668,"15":8651,"16":8680,"17":10005,"18":8489,"19":8647,"20":9799,"21":9834,"22":8599,"23":9819,"24":10198}},
  {"leagueId":109,"season":"2019/2020","positions":{"1":9795,"2":9784,"3":8401,"4":8680,"5":9833,"6":8416,"7":8651,"8":8484,"9":9828,"10":9806,"11":10262,"12":9799,"13":10006,"14":10005,"15":8647,"16":8412,"17":8668,"18":10196,"19":9834,"20":9818,"21":8489,"22":8351,"23":8599,"24":10253}},
  {"leagueId":109,"season":"2020/2021","positions":{"1":8680,"2":9834,"3":8489,"4":8651,"5":9833,"6":10262,"7":9828,"8":9806,"9":8313,"10":8647,"11":8351,"12":10196,"13":9799,"14":8484,"15":9795,"16":8668,"17":10253,"18":10006,"19":9818,"20":8412,"21":10005,"22":8416,"23":8175,"24":8466}},
  {"leagueId":109,"season":"2021/2022","positions":{"1":9828,"2":9833,"3":8427,"4":9799,"5":9818,"6":8651,"7":9806,"8":8313,"9":9795,"10":10196,"11":8484,"12":8175,"13":8680,"14":8351,"15":10006,"16":8668,"17":10262,"18":8647,"19":10253,"20":8412,"21":8416,"22":8489,"23":8668,"24":8412}},
  {"leagueId":109,"season":"2022/2023","positions":{"1":8351,"2":10253,"3":10196,"4":10262,"5":9795,"6":9806,"7":9818,"8":8484,"9":8313,"10":8647,"11":8680,"12":8175,"13":8427,"14":8416,"15":8651,"16":10006,"17":9799,"18":8489,"19":8599,"20":8427,"21":8466,"22":8668,"23":8412,"24":9834}},
  {"leagueId":109,"season":"2023/2024","positions":{"1":9795,"2":9818,"3":10253,"4":8484,"5":8647,"6":9806,"7":8680,"8":8175,"9":8313,"10":8351,"11":8416,"12":10006,"13":10262,"14":8489,"15":10196,"16":8651,"17":9799,"18":8427,"19":8466,"20":8668,"21":8412,"22":9834,"23":8599,"24":8427}},
  {"leagueId":108,"season":"2024/2025","positions":{"1":8658,"2":9841,"3":10007,"4":8451,"5":8676,"6":8351,"7":9798,"8":8559,"9":8483,"10":9796,"11":8430,"12":8283,"13":8119,"14":10253,"15":8528,"16":9833,"17":9818,"18":8677,"19":8651,"20":9792,"21":8647,"22":10104,"23":9834,"24":9896}},
  {"leagueId":109,"season":"2024/2025","positions":{"1":9903,"2":9799,"3":8484,"4":10006,"5":158319,"6":9819,"7":9786,"8":9806,"9":10005,"10":8416,"11":10602,"12":9795,"13":9784,"14":45723,"15":8680,"16":8175,"17":10173,"18":10603,"19":8645,"20":8313,"21":8671,"22":10262,"23":10196,"24":8489}}
]
`

/////////////////////////////////////////////////////////////////////////
////// Initial Positions
/////////////////////////////////////////////////////////////////////////

const INITIAL_POSITIONS = `[
  {"leagueId":47,"season":"2010/2011","positions":{"1":8455,"2":10260,"3":9825,"4":8586,"5":8456,"6":10252,"7":8650,"8":8668,"9":8658,"10":8655,"11":10194,"12":9879,"13":8472,"14":8559,"15":8602,"16":8528,"17":8654,"18":10261,"19":8659,"20":8483}},
  {"leagueId":47,"season":"2011/2012","positions":{"1":10260,"2":8455,"3":8456,"4":9825,"5":8586,"6":8650,"7":8668,"8":9879,"9":10252,"10":8472,"11":8659,"12":10261,"13":10194,"14":8559,"15":8655,"16":8528,"17":8602,"18":10172,"19":9850,"20":10003}},
  {"leagueId":47,"season":"2012/2013","positions":{"1":8456,"2":10260,"3":9825,"4":8586,"5":10261,"6":8455,"7":8668,"8":8650,"9":9879,"10":8659,"11":10003,"12":9850,"13":8472,"14":10194,"15":8528,"16":10252,"17":10172,"18":9798,"19":8466,"20":8654}},
  {"leagueId":47,"season":"2013/2014","positions":{"1":10260,"2":8456,"3":8455,"4":9825,"5":8586,"6":8668,"7":8650,"8":8659,"9":10003,"10":8654,"11":9850,"12":9879,"13":10194,"14":8466,"15":10252,"16":10261,"17":8472,"18":8344,"19":8667,"20":9826}},
  {"leagueId":47,"season":"2014/2015","positions":{"1":8456,"2":8650,"3":8455,"4":9825,"5":8668,"6":8586,"7":10260,"8":8466,"9":10194,"10":10261,"11":9826,"12":10003,"13":8654,"14":8472,"15":10252,"16":8667,"17":8659,"18":8197,"19":8191,"20":10172}},
  {"leagueId":47,"season":"2015/2016","positions":{"1":8455,"2":8456,"3":9825,"4":10260,"5":8586,"6":8650,"7":8466,"8":10003,"9":10194,"10":9826,"11":8668,"12":8654,"13":8659,"14":8197,"15":10261,"16":8472,"17":10252,"18":8678,"19":9817,"20":9850}},
  {"leagueId":47,"season":"2016/2017","positions":{"1":8197,"2":9825,"3":8586,"4":8456,"5":10260,"6":8466,"7":8654,"8":8650,"9":10194,"10":8455,"11":8668,"12":10003,"13":9817,"14":8659,"15":9826,"16":8678,"17":8472,"18":8191,"19":8549,"20":8667}},
  {"leagueId":47,"season":"2017/2018","positions":{"1":8455,"2":8586,"3":8456,"4":8650,"5":9825,"6":10260,"7":8668,"8":8466,"9":8678,"10":8659,"11":8654,"12":8197,"13":10194,"14":9826,"15":10003,"16":8191,"17":9817,"18":10261,"19":10204,"20":9796}},
  {"leagueId":47,"season":"2018/2019","positions":{"1":8456,"2":10260,"3":8586,"4":8650,"5":8455,"6":9825,"7":8191,"8":8668,"9":8197,"10":10261,"11":9826,"12":8678,"13":8654,"14":9817,"15":10204,"16":9796,"17":8466,"18":8602,"19":8344,"20":9879}},
  {"leagueId":47,"season":"2019/2020","positions":{"1":8456,"2":8650,"3":8455,"4":8586,"5":9825,"6":10260,"7":8602,"8":8668,"9":8197,"10":8654,"11":9817,"12":9826,"13":10261,"14":8678,"15":8191,"16":8466,"17":10204,"18":9850,"19":8657,"20":10252}},
  {"leagueId":47,"season":"2020/2021","positions":{"1":8650,"2":8456,"3":10260,"4":8455,"5":8197,"6":8586,"7":8602,"8":9825,"9":8657,"10":8191,"11":8466,"12":8668,"13":10261,"14":9826,"15":10204,"16":8654,"17":10252,"18":8463,"19":8659,"20":9879}},
  {"leagueId":47,"season":"2021/2022","positions":{"1":8456,"2":10260,"3":8650,"4":8455,"5":8197,"6":8654,"7":8586,"8":9825,"9":8463,"10":8668,"11":10252,"12":10261,"13":8602,"14":9826,"15":8466,"16":10204,"17":8191,"18":9850,"19":9817,"20":9937}},
  {"leagueId":47,"season":"2022/2023","positions":{"1":8456,"2":8650,"3":8455,"4":8586,"5":9825,"6":10260,"7":8654,"8":8197,"9":10204,"10":8602,"11":10261,"12":9826,"13":9937,"14":10252,"15":8466,"16":8668,"17":8463,"18":9879,"19":8678,"20":10203}},
  {"leagueId":47,"season":"2023/2024","positions":{"1":8456,"2":9825,"3":10260,"4":10261,"5":8650,"6":10204,"7":10252,"8":8586,"9":9937,"10":9879,"11":9826,"12":8455,"13":8602,"14":8654,"15":8678,"16":10203,"17":8668,"18":8191,"19":8657,"20":8346}},
  {"leagueId":47,"season":"2024/2025","positions":{"1":8456,"2":9825,"3":8650,"4":10252,"5":8586,"6":8455,"7":10261,"8":10260,"9":8654,"10":9826,"11":10204,"12":8678,"13":9879,"14":8602,"15":8668,"16":9937,"17":10203,"18":8197,"19":9902,"20":8466}},
  {"leagueId":47,"season":"2025/2026","positions":{"1":8650,"2":9825,"3":8456,"4":8455,"5":10261,"6":8586,"7":10252,"8":10260,"9":8654,"10":9826,"11":10204,"12":8678,"13":9879,"14":8602,"15":8668,"16":9937,"17":10203,"18":8463,"19":8191,"20":8472}},
  {"leagueId":48,"season":"2010/2011","positions":{"1":8191,"2":8667,"3":8462,"4":10203,"5":8344,"6":8197,"7":10003,"8":8657,"9":9798,"10":8427,"11":8549,"12":9903,"13":10172,"14":10170,"15":9902,"16":9817,"17":8411,"18":8283,"19":8669,"20":8412,"21":9826,"22":9850,"23":8463,"24":10004}},
  {"leagueId":48,"season":"2011/2012","positions":{"1":8658,"2":8483,"3":8654,"4":8344,"5":9798,"6":10203,"7":8463,"8":8191,"9":10004,"10":8197,"11":8667,"12":8549,"13":9902,"14":9817,"15":8427,"16":8462,"17":8283,"18":8669,"19":10170,"20":9826,"21":9903,"22":10204,"23":8466,"24":8677}},
  {"leagueId":48,"season":"2012/2013","positions":{"1":8559,"2":8655,"3":8602,"4":8658,"5":8483,"6":8344,"7":8549,"8":8667,"9":8197,"10":10204,"11":9817,"12":10170,"13":8191,"14":8463,"15":9902,"16":10004,"17":9826,"18":8677,"19":10203,"20":8427,"21":8283,"22":8451,"23":10163,"24":9796}},
  {"leagueId":48,"season":"2013/2014","positions":{"1":8528,"2":9798,"3":10172,"4":9817,"5":10204,"6":8197,"7":8559,"8":10203,"9":8451,"10":10170,"11":8191,"12":8658,"13":8463,"14":9902,"15":8483,"16":8549,"17":8655,"18":10163,"19":9796,"20":10004,"21":8283,"22":9903,"23":8678,"24":10198}},
  {"leagueId":48,"season":"2014/2015","positions":{"1":9850,"2":9879,"3":8344,"4":10170,"5":8528,"6":10204,"7":9798,"8":8655,"9":9902,"10":8678,"11":10203,"12":8549,"13":9817,"14":8559,"15":8463,"16":10163,"17":9796,"18":8451,"19":10004,"20":8483,"21":8658,"22":8602,"23":9937,"24":8119}},
  {"leagueId":48,"season":"2015/2016","positions":{"1":8667,"2":8191,"3":10172,"4":8549,"5":9937,"6":9902,"7":8602,"8":10170,"9":8655,"10":8658,"11":8344,"12":8451,"13":10163,"14":10203,"15":8463,"16":9796,"17":9879,"18":8559,"19":9798,"20":10204,"21":8119,"22":8427,"23":8645,"24":8411}},
  {"leagueId":48,"season":"2016/2017","positions":{"1":10261,"2":9850,"3":10252,"4":10204,"5":10170,"6":10163,"7":9902,"8":8344,"9":9937,"10":8658,"11":8411,"12":10172,"13":8463,"14":8602,"15":8655,"16":10203,"17":9798,"18":8427,"19":9796,"20":9879,"21":8119,"22":8528,"23":9792,"24":8283}},
  {"leagueId":48,"season":"2017/2018","positions":{"1":8667,"2":8549,"3":8472,"4":9798,"5":10163,"6":9879,"7":8463,"8":9850,"9":10170,"10":9937,"11":8411,"12":8344,"13":10252,"14":8283,"15":8602,"16":9902,"17":8427,"18":10172,"19":8658,"20":9792,"21":10203,"22":8657,"23":8559,"24":10004}},
  {"leagueId":48,"season":"2018/2019","positions":{"1":10003,"2":10194,"3":8659,"4":10252,"5":8549,"6":10170,"7":8411,"8":10004,"9":9937,"10":8657,"11":8427,"12":9902,"13":8463,"14":9850,"15":10163,"16":10172,"17":10203,"18":8667,"19":8658,"20":9798,"21":8559,"22":8528,"23":8655,"24":8119}},
  {"leagueId":48,"season":"2019/2020","positions":{"1":8344,"2":9879,"3":9796,"4":8463,"5":8659,"6":10170,"7":8549,"8":8427,"9":10203,"10":10003,"11":9937,"12":10163,"13":8667,"14":8411,"15":8655,"16":10194,"17":8658,"18":8528,"19":10172,"20":9798,"21":10004,"22":8346,"23":8283,"24":8451}},
  {"leagueId":48,"season":"2020/2021","positions":{"1":8678,"2":9817,"3":9850,"4":9937,"5":8344,"6":10003,"7":10203,"8":10004,"9":8411,"10":10170,"11":8655,"12":8427,"13":10172,"14":9798,"15":10194,"16":10163,"17":8549,"18":9796,"19":8346,"20":8658,"21":8283,"22":8669,"23":8119,"24":8676}},
  {"leagueId":48,"season":"2021/2022","positions":{"1":9879,"2":8659,"3":8657,"4":10003,"5":8283,"6":8678,"7":9798,"8":8344,"9":10172,"10":8549,"11":10004,"12":8346,"13":8411,"14":10194,"15":8655,"16":8669,"17":10203,"18":8658,"19":8427,"20":9796,"21":10170,"22":8667,"23":8677,"24":8483}},
  {"leagueId":48,"season":"2022/2023","positions":{"1":8191,"2":9817,"3":9850,"4":9796,"5":8657,"6":8346,"7":8549,"8":8655,"9":10004,"10":8659,"11":10172,"12":8669,"13":8411,"14":10194,"15":10003,"16":8483,"17":8427,"18":8344,"19":8667,"20":8658,"21":9798,"22":8528,"23":8119,"24":8472}},
  {"leagueId":48,"season":"2023/2024","positions":{"1":8197,"2":8463,"3":8466,"4":8549,"5":8669,"6":8472,"7":8655,"8":10004,"9":8659,"10":10003,"11":9817,"12":8411,"13":9850,"14":8427,"15":8667,"16":10194,"17":8658,"18":9796,"19":8119,"20":10172,"21":8344,"22":8401,"23":9902,"24":10163}},
  {"leagueId":48,"season":"2024/2025","positions":{"1":8346,"2":8191,"3":8657,"4":8463,"5":8659,"6":9850,"7":8667,"8":8549,"9":8669,"10":8411,"11":8427,"12":8344,"13":10004,"14":10003,"15":9817,"16":8472,"17":10194,"18":10172,"19":8655,"20":10163,"21":8401,"22":8462,"23":10170,"24":8653}},
  {"leagueId":48,"season":"2025/2026","positions":{"1":8197,"2":9902,"3":8466,"4":8463,"5":8659,"6":9850,"7":8667,"8":8549,"9":8669,"10":8411,"11":8427,"12":10004,"13":10003,"14":9817,"15":8472,"16":10194,"17":10261,"18":8655,"19":8658,"20":9841,"21":8451,"22":8344,"23":10172,"24":8401}},
  {"leagueId":108,"season":"2010/2011","positions":{"1":10163,"2":8401,"3":8677,"4":8451,"5":9795,"6":9796,"7":8466,"8":8416,"9":9937,"10":10006,"11":10104,"12":8645,"13":10204,"14":10196,"15":10198,"16":9785,"17":8351,"18":9833,"19":8313,"20":8488,"21":9819,"22":8678,"23":8493,"24":8009}},
  {"leagueId":108,"season":"2011/2012","positions":{"1":8411,"2":8657,"3":8412,"4":9796,"5":8645,"6":8678,"7":8351,"8":9833,"9":8493,"10":8416,"11":9937,"12":10196,"13":8451,"14":10198,"15":10163,"16":8488,"17":9785,"18":8313,"19":9819,"20":10006,"21":9786,"22":9895,"23":8676,"24":10253}},
  {"leagueId":108,"season":"2012/2013","positions":{"1":8462,"2":8669,"3":9903,"4":8657,"5":8645,"6":10253,"7":9819,"8":10196,"9":9937,"10":8416,"11":8678,"12":8313,"13":8488,"14":9895,"15":8411,"16":9785,"17":10198,"18":8412,"19":10006,"20":8351,"21":9795,"22":9896,"23":8647,"24":9784}},
  {"leagueId":108,"season":"2013/2014","positions":{"1":8677,"2":8602,"3":8427,"4":9937,"5":8657,"6":9795,"7":8351,"8":8645,"9":10006,"10":8647,"11":8313,"12":9819,"13":9784,"14":8411,"15":8669,"16":9896,"17":10196,"18":10253,"19":9785,"20":8416,"21":10173,"22":8119,"23":9799,"24":8484}},
  {"leagueId":108,"season":"2014/2015","positions":{"1":9903,"2":8283,"3":10198,"4":8351,"5":8411,"6":8677,"7":8657,"8":9795,"9":9799,"10":8645,"11":8484,"12":8427,"13":10006,"14":8647,"15":9785,"16":8416,"17":10173,"18":8669,"19":9784,"20":9819,"21":9786,"22":8412,"23":8493,"24":45723}},
  {"leagueId":108,"season":"2015/2016","positions":{"1":10004,"2":8528,"3":8483,"4":9795,"5":8657,"6":9786,"7":8484,"8":8493,"9":8677,"10":45723,"11":8283,"12":10173,"13":9903,"14":10006,"15":9785,"16":8412,"17":8669,"18":9799,"19":8416,"20":9784,"21":9792,"22":9896,"23":9895,"24":8652}},
  {"leagueId":108,"season":"2016/2017","positions":{"1":8451,"2":8645,"3":8559,"4":10006,"5":10004,"6":8484,"7":8412,"8":8669,"9":10173,"10":8493,"11":8657,"12":9799,"13":8677,"14":8652,"15":9795,"16":9895,"17":9785,"18":9786,"19":45723,"20":9896,"21":8651,"22":8653,"23":10104,"24":158319}},
  {"leagueId":108,"season":"2017/2018","positions":{"1":8655,"2":8528,"3":8119,"4":8412,"5":45723,"6":8484,"7":8652,"8":8653,"9":8493,"10":10104,"11":8677,"12":8645,"13":8451,"14":10006,"15":158319,"16":8651,"17":9785,"18":9896,"19":9895,"20":10173,"21":8462,"22":8401,"23":9903,"24":8483}},
  {"leagueId":108,"season":"2018/2019","positions":{"1":8283,"2":9792,"3":8472,"4":9896,"5":8412,"6":8451,"7":8401,"8":8462,"9":8677,"10":8652,"11":8484,"12":8483,"13":10104,"14":45723,"15":9903,"16":8653,"17":10173,"18":158319,"19":10006,"20":8493,"21":8671,"22":8346,"23":8676,"24":8669}},
  {"leagueId":108,"season":"2019/2020","positions":{"1":8119,"2":8559,"3":9902,"4":8462,"5":8472,"6":9903,"7":8677,"8":8669,"9":9792,"10":8483,"11":45723,"12":8653,"13":10173,"14":8671,"15":10104,"16":8493,"17":8676,"18":9896,"19":8652,"20":158319,"21":8430,"22":8645,"23":8313}},
  {"leagueId":108,"season":"2020/2021","positions":{"1":8451,"2":8528,"3":8667,"4":8653,"5":8462,"6":45723,"7":8677,"8":8472,"9":9903,"10":10173,"11":9902,"12":9792,"13":8483,"14":10104,"15":9896,"16":8430,"17":8671,"18":8493,"19":8645,"20":158319,"21":9795,"22":9784,"23":8401,"24":8651}},
  {"leagueId":108,"season":"2021/2022","positions":{"1":8676,"2":8119,"3":10163,"4":8472,"5":8430,"6":8653,"7":8451,"8":8462,"9":9902,"10":10173,"11":8671,"12":9784,"13":8645,"14":9903,"15":45723,"16":9792,"17":9896,"18":8401,"19":158319,"20":8528,"21":8680,"22":9834,"23":8559,"24":8489}},
  {"leagueId":108,"season":"2022/2023","positions":{"1":8677,"2":10170,"3":8283,"4":8645,"5":10163,"6":8676,"7":8401,"8":8653,"9":8559,"10":8462,"11":9902,"12":8671,"13":8451,"14":9834,"15":8680,"16":9792,"17":8430,"18":9896,"19":8489,"20":45723,"21":9828,"22":9833,"23":10104,"24":9799}},
  {"leagueId":108,"season":"2023/2024","positions":{"1":9798,"2":8483,"3":8528,"4":8283,"5":8559,"6":8677,"7":10170,"8":8462,"9":8676,"10":8451,"11":8430,"12":9896,"13":45723,"14":9833,"15":9792,"16":8680,"17":10104,"18":9799,"19":8653,"20":9834,"21":8351,"22":10253,"23":8651,"24":10196}},
  {"leagueId":108,"season":"2024/2025","positions":{"1":8658,"2":9796,"3":8119,"4":8559,"5":8677,"6":8283,"7":8430,"8":8483,"9":10253,"10":8676,"11":8351,"12":8528,"13":9833,"14":8651,"15":10104,"16":8451,"17":9798,"18":9834,"19":9896,"20":9792,"21":10007,"22":9841,"23":9818,"24":8647}},
  {"leagueId":108,"season":"2025/2026","positions":{"1":8344,"2":10172,"3":8401,"4":10007,"5":8676,"6":8351,"7":9798,"8":8559,"9":8483,"10":9796,"11":8430,"12":8283,"13":8119,"14":10253,"15":8528,"16":9833,"17":9818,"18":8677,"19":8651,"20":9792,"21":8647,"22":10104,"23":9834,"24":9896}},
  {"leagueId":109,"season":"2010/2011","positions":{"1":8671,"2":158319,"3":9792,"4":9786,"5":8313,"6":8351,"7":8175,"8":10196,"9":10262,"10":9834,"11":9818,"12":9833,"13":8680,"14":10005,"15":8647,"16":9784,"17":10253,"18":8489,"19":8599,"20":8416,"21":8488,"22":8009,"23":9916,"24":10198}},
  {"leagueId":109,"season":"2011/2012","positions":{"1":9795,"2":9896,"3":8647,"4":8652,"5":10193,"6":8680,"7":9784,"8":10173,"9":8653,"10":8119,"11":8465,"12":9799,"13":10104,"14":8671,"15":8489,"16":158319,"17":9792,"18":8484,"19":8009,"20":8651,"21":8401,"22":8175,"23":799249,"24":8599}},
  {"leagueId":109,"season":"2012/2013","positions":{"1":8676,"2":9786,"3":9833,"4":8493,"5":9795,"6":9896,"7":8647,"8":8652,"9":10193,"10":8680,"11":9784,"12":10173,"13":8653,"14":8119,"15":8465,"16":9799,"17":10104,"18":8671,"19":8489,"20":158319,"21":9792,"22":8484,"23":9818,"24":10262}},
  {"leagueId":109,"season":"2013/2014","positions":{"1":8412,"2":9895,"3":8488,"4":8462,"5":10173,"6":8119,"7":9799,"8":9792,"9":8680,"10":8651,"11":8484,"12":9786,"13":8653,"14":9833,"15":8652,"16":8493,"17":45723,"18":10104,"19":8676,"20":8489,"21":9916,"22":8671,"23":9818,"24":1026}},
  {"leagueId":109,"season":"2014/2015","positions":{"1":8313,"2":10196,"3":9896,"4":10253,"5":9786,"6":8412,"7":8493,"8":45723,"9":8652,"10":9792,"11":9916,"12":8653,"13":8009,"14":8401,"15":9818,"16":9895,"17":8462,"18":10262,"19":8671,"20":9833,"21":8680,"22":8489,"23":8346,"24":9834}},
  {"leagueId":109,"season":"2015/2016","positions":{"1":9792,"2":9896,"3":8652,"4":8671,"5":8401,"6":8462,"7":158319,"8":8351,"9":9834,"10":10196,"11":8346,"12":9818,"13":8676,"14":9833,"15":8175,"16":8488,"17":9819,"18":10253,"19":10198,"20":8647,"21":8489,"22":10262,"23":8680,"24":8313}},
  {"leagueId":109,"season":"2016/2017","positions":{"1":8651,"2":8653,"3":10104,"4":8346,"5":9833,"6":10196,"7":8483,"8":8416,"9":8676,"10":10253,"11":9834,"12":9818,"13":8671,"14":10005,"15":8175,"16":9819,"17":9784,"18":8489,"19":8647,"20":10198,"21":8680,"22":10262,"23":9903,"24":9895}},
  {"leagueId":109,"season":"2017/2018","positions":{"1":8462,"2":8401,"3":9903,"4":9833,"5":9819,"6":8669,"7":8430,"8":9818,"9":9795,"10":10196,"11":10262,"12":9834,"13":8416,"14":8647,"15":9784,"16":10253,"17":8680,"18":10005,"19":10198,"20":9799,"21":9828,"22":8489,"23":8671,"24":8346}},
  {"leagueId":109,"season":"2018/2019","positions":{"1":8671,"2":8346,"3":8676,"4":9818,"5":9828,"6":8313,"7":10262,"8":8416,"9":9833,"10":10253,"11":10196,"12":9784,"13":9795,"14":8668,"15":8651,"16":8680,"17":10005,"18":8489,"19":8647,"20":9799,"21":9834,"22":8599,"23":8430,"24":9895}},
  {"leagueId":109,"season":"2019/2020","positions":{"1":8430,"2":9895,"3":8645,"4":8680,"5":9833,"6":8416,"7":8651,"8":8484,"9":9828,"10":9806,"11":10262,"12":9799,"13":10006,"14":10005,"15":8647,"16":8412,"17":8668,"18":10196,"19":9834,"20":9818,"21":8489,"22":8313,"23":8671,"24":10253}},
  {"leagueId":109,"season":"2020/2021","positions":{"1":9795,"2":9784,"3":8401,"4":8651,"5":9833,"6":10262,"7":9828,"8":9806,"9":8313,"10":8647,"11":8351,"12":10196,"13":9799,"14":8484,"15":9795,"16":8668,"17":10253,"18":10006,"19":9818,"20":8412,"21":8680,"22":8175,"23":8489,"24":8351}},
  {"leagueId":109,"season":"2021/2022","positions":{"1":8680,"2":9834,"3":8489,"4":9799,"5":9818,"6":8651,"7":9806,"8":8313,"9":9795,"10":10196,"11":8484,"12":8175,"13":8680,"14":8351,"15":10006,"16":8668,"17":10262,"18":8647,"19":10253,"20":8412,"21":8427,"22":9833,"23":10104,"24":9828}},
  {"leagueId":109,"season":"2022/2023","positions":{"1":9828,"2":9833,"3":8427,"4":8651,"5":9806,"6":9818,"7":8484,"8":8313,"9":9795,"10":10196,"11":8484,"12":8175,"13":8680,"14":8351,"15":10006,"16":8668,"17":10262,"18":8647,"19":10253,"20":8412,"21":8351,"22":10253,"23":8489,"24":8599}},
  {"leagueId":109,"season":"2023/2024","positions":{"1":8351,"2":10253,"3":10196,"4":9795,"5":9806,"6":9818,"7":8484,"8":8313,"9":8647,"10":8680,"11":8175,"12":8427,"13":8416,"14":8651,"15":10006,"16":9799,"17":8489,"18":8599,"19":10262,"20":8668,"21":8412,"22":9834,"23":8680,"24":8175}},
  {"leagueId":109,"season":"2024/2025","positions":{"1":9795,"2":9818,"3":10253,"4":8647,"5":9806,"6":8680,"7":8175,"8":8313,"9":8351,"10":8416,"11":10006,"12":10262,"13":8489,"14":10196,"15":8651,"16":9799,"17":8427,"18":8466,"19":8668,"20":8412,"21":8484,"22":9834,"23":8599,"24":8427}},
  {"leagueId":109,"season":"2025/2026","positions":{"1":10104,"2":9834,"3":9896,"4":9903,"5":9799,"6":8484,"7":10006,"8":158319,"9":9819,"10":9786,"11":9806,"12":10005,"13":8416,"14":10602,"15":9795,"16":9784,"17":45723,"18":8680,"19":8175,"20":8313,"21":8671,"22":10262,"23":45729,"24":158316}}
]`

/////////////////////////////////////////////////////////////////////////
////// Team Data
/////////////////////////////////////////////////////////////////////////

func GetDataInstance() *Data {
	if DataInstance != nil {
		return DataInstance
	}

	teamsData := make(map[string]TeamData)
	err := json.Unmarshal([]byte(teamdata), &teamsData)
	if err != nil {
		logger.Fatal("failed to parse team metadata from local JSON", err)
	}

	var ip []Position
	err = json.Unmarshal([]byte(INITIAL_POSITIONS), &ip)
	if err != nil {
		logger.Fatal("failed to parse team metadata from local JSON", err)
	}

	var fp []Position
	err = json.Unmarshal([]byte(FINAL_POSITIONS), &fp)
	if err != nil {
		logger.Fatal("failed to parse team metadata from local JSON", err)
	}

	ret := Data{
		TeamsData:        teamsData,
		InitialPositions: ip,
		FinalPositions:   fp,
	}

	DataInstance = &ret
	return &ret
}

// Finds the id of the given team name if possible
func (m *Data) GetTeamId(name string) (int, error) {
	d, err := m.GetDataForTeam(name)
	if err != nil {
		return 0, err
	}
	return d.Id, nil
}

// Finds the team name for the given team id if possible
func (m *Data) GetTeamName(t any) (string, error) {
	d, err := m.GetDataForTeam(t)
	if err != nil {
		return "", err
	}
	return d.Name, nil
}

/**
* Searches the teams data for a team based on team name
 */
func (m *Data) GetDataForTeam(t any) (*TeamData, error) {
	// is teamName nil?
	if t == nil {
		return &TeamData{}, fmt.Errorf("Team name is nil")
	}

	// if we've been given a team ID in any form (int or string representation of int etc.)
	id, err := util.GetAsInteger(t)
	if err == nil {
		// search teamdata for a matching team id
		for name, team := range m.TeamsData {
			if team.Id == id {
				// Populate the Name field since it's not stored in the JSON structure
				team.Name = name
				return &team, nil
			}
		}
		return &TeamData{}, fmt.Errorf("Failed to find team data for team with id: %d", id)
	}

	// Ok we've been given a team name in some form
	tn, err := util.GetAsString(t)
	if err != nil {
		return &TeamData{}, fmt.Errorf("Failed to convert team name to string: %w", err)
	}
	
	// First try exact match with map key
	if team, exists := m.TeamsData[tn]; exists {
		team.Name = tn
		return &team, nil
	}
	
	// Now try fuzzy search against map keys
	for name, team := range m.TeamsData {
		if util.IsFuzzyMatch(name, tn) {
			team.Name = name
			return &team, nil
		}
	}
	return &TeamData{}, fmt.Errorf("Failed to find team data for team with name: %s", tn)
}

// returns the lat/long for the given team (name or id)
func (m *Data) GetLatLong(t int) (float64, float64, error) {
	d, err := m.GetDataForTeam(t)
	if err != nil {
		return 0, 0, err
	}
	return d.Latitude, d.Longitude, nil
}

// ///////////////////////////////////////////////////////////////////////
// //// Positions
// ///////////////////////////////////////////////////////////////////////

/**
* Gets the finishing position for the given team for the given season/league
 */
func (m *Data) GetFinalPosition(team any, leagueId any, season any) (int, error) {
	if team == nil {
		return -1, fmt.Errorf("must pass a valid team name or id")
	}
	td, err := m.GetDataForTeam(team)
	if err != nil {
		return -1, err
	}
	tid := td.Id
	// validate this team
	league, err := util.GetAsInteger(leagueId)
	if err != nil {
		return -1, err
	}
	seasonStr, err := ParseSeason(season)
	if err != nil {
		return -1, err
	}
	// ok we have all the sanitised parameters, now look up that season and leagueid in the FINAL_POSITIONS array
	p, err := m.GetFinalPositions(league, seasonStr)
	if err != nil {
		return -1, err
	}
	// now iterate p.Positions looking for tid
	for k, v := range p.Positions {
		if v == tid {
			// convert the key to an integer value and return it
			ret, err := util.GetAsInteger(k)
			if err != nil {
				return -1, err
			}
			return ret, nil
		}
	}
	return -1, fmt.Errorf("Failed to find team, season or league etc.")
}

/**
* Gets the initial position for the given team for the given season/league
 */
func (m *Data) GetInitialPosition(team any, leagueId any, season any) (int, error) {
	if team == nil {
		return -1, fmt.Errorf("must pass a valid team name or id")
	}
	td, err := m.GetDataForTeam(team)
	if err != nil {
		return -1, err
	}
	tid := td.Id
	// validate this team
	league, err := util.GetAsInteger(leagueId)
	if err != nil {
		return -1, err
	}
	seasonStr, err := ParseSeason(season)
	if err != nil {
		return -1, err
	}
	// ok we have all the sanitised parameters, now look up that season and leagueid in the INITIAL_POSITIONS array
	p, err := m.GetInitialPositions(league, seasonStr)
	if err != nil {
		return -1, err
	}
	// now iterate p.Positions looking for tid
	for k, v := range p.Positions {
		if v == tid {
			// convert the key to an integer value and return it
			ret, err := util.GetAsInteger(k)
			if err != nil {
				return -1, err
			}
			return ret, nil
		}
	}
	return -1, fmt.Errorf("Failed to find team, season or league etc.")
}

// Finds the position structure corresponding to the league/season in the FINAL_POSITIONS array (if it exists)
func (m *Data) GetFinalPositions(leagueId any, season any) (*Position, error) {
	league, err := util.GetAsInteger(leagueId)
	if err != nil {
		return nil, err
	}
	seasonStr, err := ParseSeason(season)
	if err != nil {
		return nil, err
	}
	if m.FinalPositions == nil {
		return nil, fmt.Errorf("Final Positions array is nil")
	}
	// ok we have all the sanitised parameters, now look up that season and leagueid in the FINAL_POSITIONS array
	for _, pos := range m.FinalPositions {
		// logger.Info("searcing for ", league, seasonStr)
		if pos.LeagueID == league && pos.Season == seasonStr {
			return &pos, nil
		}
	}
	// return error indicating what parameters we were looking for, and what we found in the array
	return nil, fmt.Errorf("Failed to find Final Positions entry for season or league etc. Looking for leagueId: %d, season: %s", league, seasonStr)
}

// returns the initial position structure for a specific league and season
func (m *Data) GetInitialPositions(leagueId int, season string) (*Position, error) {
	league, err := util.GetAsInteger(leagueId)
	if err != nil {
		return nil, err
	}
	seasonStr, err := ParseSeason(season)
	if err != nil {
		return nil, err
	}
	// ok we have all the sanitised parameters, now look up that season and leagueid in the INITIAL_POSITIONS array
	for _, pos := range m.InitialPositions {
		if pos.LeagueID == league && pos.Season == seasonStr {
			return &pos, nil
		}
	}
	return nil, fmt.Errorf("Failed to find Initial Positions entry for season or league etc. Looking for leagueId: %d, season: %s", league, seasonStr)
}
